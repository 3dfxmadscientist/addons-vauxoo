<openerp>
<data>

	 <!--
        Asset category form view
     -->

    <record model="ir.ui.view" id="view_account_amortization_category_form">
        <field name="name">account.amortization.category.form</field>
        <field name="priority">100</field>
        <field name="model">account.asset.category</field>
        <field name="arch" type="xml">
            <form string="Asset category" version="7.0">
                <group>
                    <group>
                        <field name="name"/>
                        <field name="doc_type" attrs="{'invisible':True,}"/>
                        <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                    </group>
                    <group>
                        <field name="journal_id"/>
                        <field name="account_asset_id" on_change="onchange_account_asset(account_asset_id)"/>
                        <field name="account_depreciation_id"/>
                        <field name="account_expense_depreciation_id"/>
                    </group>
                    <group string="Depreciation Dates">
                        <field name="method_time"/>
                        <field name="method_number" attrs="{'invisible':[('method_time','=','end')], 'required':[('method_time','=','number')]}"/>
                        <field name="method_period"/>
                        <field name="method_end" attrs="{'required': [('method_time','=','end')], 'invisible':[('method_time','=','number')]}"/>
                    </group>
                    <group string="Depreciation Method">
                        <field name="method"/>
                        <field name="method_progress_factor" attrs="{'invisible':[('method','=','linear')], 'required':[('method','=','degressive')]}"/>
                        <field name="prorata"/>
                        <field name="open_asset"/>
                    </group>
                    <group groups="analytic.group_analytic_accounting" string="Analytic Information">
                        <field name="account_analytic_id"/>
                    </group>
                </group>
                <separator string="Notes"/>
                <field name="note"/>
            </form>
        </field>
    </record>
    
    <!--
         Amortization category action
    -->

    <record model="ir.actions.act_window" id="action_account_amortization_category_form">
        <field name="name">Amortization Category</field>
        <field name="res_model">account.asset.category</field>
        <field name="domain">[('doc_type','=','amortization')]</field>           
        <field name="context">{'default_doc_type': 'amortization'}</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>                       
        <field name="search_view_id" ref="account_asset.view_account_asset_category_search"/>
        <field name="Help"></field>
    </record>
    <record model="ir.actions.act_window.view" id="view_amortization_category_tree">    
        <field name="act_window_id" ref='action_account_amortization_category_form'/>
        <field name="sequence">10</field>                               
        <field name="view_mode">tree</field>                            
        <field name="view_id" ref="account_asset.view_account_asset_category_tree"/>      
    </record>                                                           
    <record model="ir.actions.act_window.view" id="view_amortization_category_form">    
        <field name="act_window_id" ref='action_account_amortization_category_form'/>             
        <field name="sequence">20</field>                               
        <field name="view_mode">form</field>                            
        <field name="view_id" ref='view_account_amortization_category_form'/>                     
    </record>
    
    <!--
         Menu item for amortization category
    -->
    
    <menuitem id="menu_finance_config_amortization" name="Amortization" parent="account.menu_finance_configuration" sequence="25"/>
	<menuitem parent="menu_finance_config_amortization" id="menu_action_account_amortization_category_form" action="action_account_amortization_category_form"/>

    <!--
        Amortization form view
     -->

    <record model="ir.ui.view" id="view_account_amortization_amortization_form">
        <field name="name">account.amortization.amortization.form</field>
        <field name="priority">100</field> 
        <field name="model">account.asset.asset</field>
        <field name="arch" type="xml">
			<form string="Asset" version="7.0">
                <header>
                    <button name="validate" states="draft" string="Confirm Asset" type="object" class="oe_highlight"/>
                    <button name="set_to_close" states="open" string="Set to Close" type="object" class="oe_highlight"/>
                    <button name="set_to_draft" states="open" string="Set to Draft" type="object" />
                    <field name="state" widget="statusbar" statusbar_visible="draft,open"/>
                </header>
                <sheet>
                    <div class="oe_button_box oe_right">
                        <button name="open_entries" string="Entries" type="object" class="oe_inline"/>
                    </div>
                    <div class="oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1>
                            <field name="name" class="oe_inline"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="category_id" on_change="onchange_category_id(category_id)" domain="[('doc_type','=','amortization')]"/>
                            <field name="account_analytic_id" groups="analytic.group_analytic_accounting"/>
                            <field name="code"/>
                            <field name="parent_id"/>
                        </group>
                        <group>
                            <field name="purchase_date"/>
                            <field name="date_acquisition"/>
                            <field name="currency_id" groups="base.group_multi_currency"/>
                            <field name="company_id" widget="selection" groups="base.group_multi_company" on_change="onchange_company_id(company_id)"/>
                        </group>
                    </group>
                    <notebook colspan="4">
                        <page string="General">
                            <group>
                                <group>
                                    <field name="purchase_value" widget="monetary" options="{'currency_field': 'currency_id'}" on_change="onchange_purchase_salvage_value(purchase_value, salvage_value)"/>
                                    <field name="salvage_value" widget="monetary" options="{'currency_field': 'currency_id'}" on_change="onchange_purchase_salvage_value(purchase_value, salvage_value)"/>
                                    <field name="value_residual" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="partner_id"/>
                                </group>
                                <group>
                                    <field name="method" readonly="1"/>
                                    <field name="method_progress_factor" attrs="{'invisible':[('method','=','linear')], 'required':[('method','=','degressive')]}"/>
                                    <label for="method_time"/>
                                    <div>
                                        <field name="method_time" on_change="onchange_method_time(method_time)" class="oe_inline"/>
                                        <button name="%(account_asset.action_asset_modify)d" states="open" string="Change Duration" type="action" icon="terp-stock_effects-object-colorize" class="oe_inline" colspan="1"/>
                                    </div>
                                    <field name="prorata" attrs="{'invisible': [('method_time','=','end')]}"/>
                                    <field name="method_number" attrs="{'invisible':[('method_time','=','end')], 'required':[('method_time','=','number')]}"/>
                                    <field name="method_period" string="Number of days"/>
                                    <field name="method_end" attrs="{'required': [('method_time','=','end')], 'invisible':[('method_time','=','number')]}"/>
<!--
                                    <field name="method_group"/>
-->
                                </group>
                            </group>
                        </page>
                        <page string="Depreciation Board">
                            <field name="depreciation_line_ids" mode="tree">
                                <tree string="Depreciation Lines" colors="blue:(move_check == False);black:(move_check == True)">
                                    <field name="depreciation_date"/>
                                    <field name="sequence" invisible="1"/>
                                    <field name="depreciated_value" readonly="1"/>
                                    <field name="amount"/>
                                    <field name="remaining_value" readonly="1"/>
                                    <field name="move_check"/>
                                    <field name="parent_state" invisible="1"/>
                                    <button name="create_move" attrs="{'invisible':['|',('move_check','!=',False),('parent_state','!=','open')]}" icon="gtk-execute" string="Create Move" type="object"/>
                                </tree>
                                <form string="Depreciation Lines"> 
                                    <group>
                                        <group>
                                            <field name="asset_id" invisible="1"/>
                                            <field name="parent_state" invisible="1"/>
                                            <field name="name"/>
                                            <field name="amount"/>
                                            <field name="move_id"/>
                                            <field name="move_check"/>
                                            <field name="parent_state" invisible="1"/>
                                        </group>
                                        <group>
                                            <field name="sequence"/>
                                            <field name="depreciation_date"/>
                                            <field name="depreciated_value" readonly="1"/>
                                            <field name="remaining_value" readonly="1"/>
                                        </group>
                                    </group>
                                </form>
                            </field>
                            <button type="object" name="compute_depreciation_board" string="Compute" icon="terp-stock_format-scientific" colspan="2" attrs="{'invisible':[('state','=','close')]}"/>
                        </page>
                        <page string="History">
                            <field name="account_move_line_ids" readonly="1"/>
                            <field name="history_ids" readonly="1"/>
                        </page>
                        <page string="Notes">
                            <field name="note" placeholder="Add an internal note here..."/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!--
         Amortization action
    -->

    <record model="ir.actions.act_window" id="action_account_amortization_amortization_form">
        <field name="name">Amortization</field>
        <field name="res_model">account.asset.asset</field>
        <field name="domain">[('doc_type','=','amortization')]</field>           
        <field name="context">{'default_doc_type': 'amortization'}</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>                       
        <field name="search_view_id" ref="account_asset.view_account_asset_search"/>
        <field name="Help">Amortization records according to selected parameters to generate the accounting poliza for allocating amortization expense.</field>
    </record>
    <record model="ir.actions.act_window.view" id="view_amortization_tree">    
        <field name="act_window_id" ref='action_account_amortization_amortization_form'/>
        <field name="sequence">10</field>                               
        <field name="view_mode">tree</field>                            
        <field name="view_id" ref="account_asset.view_account_asset_asset_tree"/>      
    </record>                                                           
    <record model="ir.actions.act_window.view" id="view_amortization_form">    
        <field name="act_window_id" ref='action_account_amortization_amortization_form'/>             
        <field name="sequence">20</field>                               
        <field name="view_mode">form</field>                            
        <field name="view_id" ref='view_account_amortization_amortization_form'/>                     
    </record>
    
    <!--
         Menu item for amortization
    -->
    
	<menuitem id="menu_finance_amortization" name="Amortization" parent="account.menu_finance" sequence="9"/>
    <menuitem parent="menu_finance_amortization" id="menu_action_account_amortization_amortization_form" action="action_account_amortization_amortization_form"/>

    <!--
        Overwrite asset action (adding doc_type domain)
    -->

    <record model="ir.actions.act_window" id="account_asset.action_account_asset_asset_form">
        <field name="name">Assets</field>
        <field name="res_model">account.asset.asset</field>
        <field name="domain">[('doc_type','=','deprecation')]</field>              
        <field name="context">{'default_doc_type': 'deprecation'}</field> 
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="account_asset.view_account_asset_search"/>
        <field name="Help">Assets records according to selected parameters to generate the accounting poliza for allocating deprecation expense.</field>
    </record>
    <record model="ir.actions.act_window.view" id="view_another_tree">     
        <field name="act_window_id" ref='account_asset.action_account_asset_asset_form'/>
        <field name="sequence">10</field>                                       
        <field name="view_mode">tree</field>                                    
        <field name="view_id" ref="account_asset.view_account_asset_asset_tree"/>      
    </record>                                                                   
    <record model="ir.actions.act_window.view" id="view_another_form">     
        <field name="act_window_id" ref='account_asset.action_account_asset_asset_form'/>             
        <field name="sequence">20</field>                                       
        <field name="view_mode">form</field>                                    
        <field name="view_id" ref='account_asset.view_account_asset_asset_form'/>                     
     </record>

    <!--
         Amortization hierarchy view action
    -->

    <record model="ir.actions.act_window" id="action_account_amortization_amortization_hierarchy_tree"> 
        <field name="name">Amortization Hierarchy</field>                              
        <field name="res_model">account.asset.asset</field>                     
        <field name="domain">[('doc_type','=','amortization'),('parent_id','=',False)]</field>
        <field name="context">{'default_doc_type': 'amortization'}</field>
        <field name="view_type">tree</field>                                    
        <field name="view_mode">tree</field>
        <field name="Help">Amortization records in hierarchy view, allows grouping regarding parent record.</field>
    </record> 
    <record model="ir.actions.act_window.view" id="view_another_hierarchy">          
        <field name="act_window_id" ref='action_account_amortization_amortization_hierarchy_tree'/>     
        <field name="sequence">10</field>                                       
        <field name="view_mode">tree</field>                         
        <field name="view_id" ref="account_asset.view_account_asset_asset_hierarchy_tree"/>
    </record>  
  
    <!--
		Overwrite asset hierarchy action (adding doc_type domain)
	-->  
	
	<record model="ir.actions.act_window" id="account_asset.action_account_asset_asset_tree"> 
        <field name="name">Asset Hierarchy</field>                              
        <field name="res_model">account.asset.asset</field>                     
        <field name="domain">[('doc_type','=','deprecation'),('parent_id','=',False)]</field>
        <field name="context">{'default_doc_type': 'deprecation'}</field>
        <field name="view_type">tree</field>                                    
        <field name="view_mode">tree</field>
        <field name="Help"></field>
    </record> 
    <record model="ir.actions.act_window.view" id="account_asset.view_another_asset_hierarchy">          
        <field name="act_window_id" ref='account_asset.action_account_asset_asset_tree'/>     
        <field name="sequence">10</field>                                       
        <field name="view_mode">tree</field>                         
        <field name="view_id" ref="account_asset.view_account_asset_asset_hierarchy_tree"/>
    </record> 

    <!--
         Menu item for call hierarchy amortization action
    -->

    <menuitem parent="menu_finance_amortization" id="menu_action_account_amortization_amortization_hierarchy_tree"
        sequence="100" action="action_account_amortization_amortization_hierarchy_tree"/>
        
    <!--
        Overwrite asset category action (adding doc_type domain)
    -->

    <record model="ir.actions.act_window" id="account_asset.action_account_asset_asset_list_normal">
        <field name="name">Asset Categories</field>
        <field name="res_model">account.asset.category</field>
        <field name="domain">[('doc_type','=','deprecation')]</field>              
        <field name="context">{'default_doc_type': 'deprecation'}</field> 
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="account_asset.view_account_asset_category_search"/>
        <field name="Help"></field>
    </record>
    <record model="ir.actions.act_window.view" id="view_category_tree">     
        <field name="act_window_id" ref="account_asset.action_account_asset_asset_list_normal"/>
        <field name="sequence">10</field>                                       
        <field name="view_mode">tree</field>                                    
        <field name="view_id" ref="account_asset.view_account_asset_category_tree"/>      
    </record>                                                                   
    <record model="ir.actions.act_window.view" id="view_category_form">     
        <field name="act_window_id" ref="account_asset.action_account_asset_asset_list_normal"/>             
        <field name="sequence">20</field>                                       
        <field name="view_mode">form</field>                                    
        <field name="view_id" ref="account_asset.view_account_asset_category_form"/>                     
    </record>
    
    <record model="ir.ui.view" id="view_account_asset_analytic_form">
        <field name="name">account.asset.asset.form</field>
        <field name="model">account.asset.asset</field>
        <field name="inherit_id" ref="account_asset.view_account_asset_asset_form"/>
        <field name="arch" type="xml">
            <xpath expr='//field[@name="category_id"]' position='replace'>
                <field name="category_id" on_change="onchange_category_id(category_id)" domain="[('doc_type','=','deprecation')]"/>
            </xpath>
        </field>
    </record>

</data>
</openerp>
